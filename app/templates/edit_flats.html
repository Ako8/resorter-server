{% extends 'base.html' %}

{% block main %}
<style>
    .form-wrapper {
        max-width: 700px;
        margin: 0 auto;
    }

    h2 {
        margin-top: 30px;
        grid-column: span 2;
        text-align: center;
    }

    /*    sssssssssssssssssssssssssssssssss*/
    #carForm {
        display: grid;
        grid-gap: .5em;
        grid-template-areas:
            "detail1  detailTwo detail3"
            "detail1  detailThree detail4";
        grid-template-columns:33% 33% 33%;
    }


    #carForm > div:nth-child(2) {
        grid-area: detailTwo;
        height: 100%;
        position: sticky;
        top: 0;
    }
</style>
{{ ckeditor.load() }}
<div style="display: flex">
    <div class="border p-4 mt-4 shadow-lg" style="width: 600px; border-top-right-radius: 0;  border-bottom-right-radius: 0">
        <form method="post" enctype="multipart/form-data" action="{{ url_for('edit_flat', id=flat.id) }}">
            <div class="form-wrapper">
                <div class="input-group">
                    <input type="file" class="form-control" id="images" name="images"
                           aria-describedby="inputGroupFileAddon04" aria-label="Upload" multiple>
                    <div class="btn border btn-outline-secondary">
                        <label for="delimage">Delete</label>
                        <input class="form-check-input m-2 border" type="checkbox" id="delimage" name="delimage"
                               aria-label="Checkbox for following text input">
                    </div>
                </div>

                <div class="mb-3 form-group">
                    <label class="form-label" for="name">Name</label>
                    <input type="text" class="form-control" value="{{ flat.name }}" name="name" id="name">
                </div>

                <div class="mb-3 form-group">
                    <label class="form-label">Overview</label>
                    {{ ckeditor.create(value=flat.overview, name='overview' ) }}
                </div>

                <div class="mb-3 form-group">
                    <label class="form-label" for="day_price">Day price</label>
                    <input type="number" class="form-control" name="day_price" id="day_price"
                           value="{{ flat.day_price }}">
                </div>

                <div class="mb-3 form-group">
                    <label class="form-label" for="location">Location</label>
                    <input type="text" class="form-control" name="location" id="location"
                           value="{{ flat.location }}">
                </div>

                <div class="mb-3 form-group">
                    <label class="form-label" for="region">Region</label>
                    <select data-allow-blank="1" class="form-select" id="region" name="region" tabindex="-1"
                            title="Region">
                        {% for reg in regions %}
                        <option value="{{ reg.id }}">{{reg.name}}</option>
                        {% endfor %}

                    </select>
                </div>

                <div class="mb-3 form-group">
                    <label class="form-label" for="flat_type">Flat Type</label>
                    <select data-allow-blank="1" class="form-select" data-role="select2" id="flat_type"
                            name="flat_type"
                            tabindex="-1" title="Flat Type">
                        {% for type in flat_types %}
                        <option value="{{ type.id }}">{{type.name}}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="mb-3 form-group">
                    <label class="form-label" for="map">Map</label>
                    <input type="text" class="form-control" name="map" id="map"
                           value="{{ flat.map }}">
                </div>

                <button type="submit" class="btn btn-primary">Save</button>
                <a href="{{ url_for('manage_flats') }}" type="submit"
                   class="btn btn-outline-secondary">Cancel</a>
            </div>
        </form>
    </div>
    <div class="border p-4 mt-4" style="width: 450px; border-top-left-radius: 0;  border-bottom-left-radius: 0">
        <div class="mt-5">
            <h3>Owner: {{ flat.flat_owner}}</h3>
            <div class="mt-3" style="display: flex; justify-content: space-between; flex-wrap: wrap">
            {% for img in flat_images.images %}
                <img src="data:image/png;base64,{{ img }}" style="margin-bottom: 20px; display: flex; height: 160px;"  alt="Image">
            {% endfor %}
            </div>
            <h3>{{flat.name}} Orders</h3>

            <table class="table table-sm">
                <thead>
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Rent Date</th>
                    <th scope="col">Unrent Date</th>
                </tr>
                </thead>
                <tbody>
                {% for ord in flat_orders %}
                <tr>
                    <th scope="row">{{ ord.id }}</th>
                    <td>{{ ord.rent_date }}</td>
                    <td>{{ ord.unrent_date }}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}